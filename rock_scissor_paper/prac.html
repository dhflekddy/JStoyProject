<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8>
<tittle>Rock_Scissors_Paper</title>
    <style>
        #computer{
            width:142px;
            height:202px;
        }
    </style>
</head>
<body>
    <div id="computer"></div>
    <div>
    <button id="rock">rock</button>
    <button id="scissors">scissors</button>
    <button id="paper">paper</button>
    </div>
    <div id="score">0</div>
    <script>
        $computer=document.querySelector("#computer");
        $score=document.querySelector("#score");
        $rock=document.querySelector("#rock");
        $scissors=document.querySelector("#scissors");
        $paper=document.querySelector("#paper");
        const IMG_URL = './rsp.png';
        
        const rspX={
            scissors:'0',
            rock:"-220px",
            paper:"-440px",
            
        };
        let computerChoice="scissors";
        //작은 따옴표를 큰 따옴표로 고쳐봄, computerChoice조건문에 이기는 값으로 바꿈
        const changeComputerHand=()=>{
            if(computerChoice=="rock"){
                computerChoice="paper";
            }
            else if(computerChoice=="scissors"){
                computerChoice="rock";
            }
            else if(computerChoice=="paper"){
                computerChoice="scissors";
            }
            $computer.style.background=`url(${IMG_URL}) ${rspX[computerChoice]} 0`;
            $computer.style.backgroundSize='auto 200px';
        }

        let intervalId=setInterval(changeComputerHand, 200);

        const scoreTable={
            rock:0,
            scissors:1,
            paper:-1,
        };

        let clickable=true;
        let computer=0;
        let me=0;   

        const clickButton=(event)=>{
            if(clickable){
                clearInterval(intervalId)
                clickable=false;
                
                const myChoice=event.target.textContent==="rock"?
                "rock":event.target.textContent==="scissors"?"scissors":"paper";

                const myScore=scoreTable[myChoice];
                const computerScore=scoreTable[computerChoice];
                const diff=myScore-computerScore;

                let message;
                if([2,-1].includes(diff)){
                    me+=1;
                    message="WIN!!!";
                }
                else if([-2,1].includes(diff)){
                    computer+=1;
                    message="LOSE!!!";
                }
                else{
                    message="DRAW";
                }
                if(me===3){
                    $score.textContent=`U WIN!! ${me}:${computer}`;
                }
                else if(computer==3){
                    $score.textContent=`U LOSE ${me}:${computer}`;
                }
                else{
                    $score.textContent=`${message} ${me}:${computer}`;
                    setTimeout(() => {
                        clickable=true;
                        intervalId=setInterval(changeComputerHand,200)
                    }, 1000);        
                    console.log("in?")
                }
            }
        };
        $rock.addEventListener("click", clickButton);
        $scissors.addEventListener("click", clickButton);
        $paper.addEventListener("click",clickButton);
    </script>
</body>
</html>